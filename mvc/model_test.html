<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>mvc.Model</title>

    <script>
      CLOSURE_NO_DEPS = true;
      CLOSURE_BASE_PATH = "../";
    </script>

    <script src="../closure-library/closure/goog/base.js"></script>
    <script src="../deps.js"></script>

    <script>
      goog.require('mvc.model.Model');
      goog.require('goog.testing.jsunit');
    </script>
  </head>
  <body>
    <script>
      function TestModel(attributes) {
          mvc.model.Model.call(this, attributes);
      };
      goog.inherits(TestModel, mvc.model.Model);


      function testBasicModel() {
          var model = new TestModel({"attr1": 1, "attr2": 2});

          assertEquals(model.get("attr1"), 1);
          assertEquals(model.get("attr2"), 2);
          assertUndefined(model.get("attr3"));

          assertObjectEquals(model.attributes, {"attr1": 1, "attr2": 2});
          assertFalse(model.changed);
      };


      function testListenBasicModelChange() {
          var model = new TestModel({"attr1": 1, "attr2": 2});
          var changes = null;

          goog.events.listen(model, 'change', function(event) {
              changes = event.attributes;
          });

          model.set({"attr1": 2});
          // event fired
          assertObjectEquals(changes, {"attr1": 2});
          assertTrue(model.changed);
          assertObjectEquals(model.attributes, {"attr1": 2, "attr2": 2});
      };
    </script>
  </body>
</html>
